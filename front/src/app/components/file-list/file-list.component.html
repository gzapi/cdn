<div class="file-list-container">
  <!-- Address Bar Navigation -->
  <div class="address-bar">
    <button mat-icon-button (click)="goToParent()" [disabled]="getPathSegments().length === 0" class="back-button">
      <mat-icon>arrow_back</mat-icon>
    </button>
    
    <div class="path-container">
      <span class="path-segment root-segment" (click)="navigateToSegment(-1)">
        <mat-icon>home</mat-icon>
        CDN
      </span>
      
      <ng-container *ngFor="let segment of getPathSegments(); let i = index">
        <mat-icon class="path-separator">chevron_right</mat-icon>
        <span class="path-segment" (click)="navigateToSegment(i)">
          {{ segment }}
        </span>
      </ng-container>
      
      <span *ngIf="getPathSegments().length === 0" class="current-folder">
        <mat-icon class="path-separator">chevron_right</mat-icon>
        <mat-icon>folder</mat-icon>
        Raiz
      </span>
    </div>
    
    <button mat-icon-button (click)="refreshFiles()" class="refresh-button" matTooltip="Atualizar arquivos">
      <mat-icon>refresh</mat-icon>
    </button>
  </div>

  <!-- Loading Spinner -->
  <div class="loading-container" *ngIf="loading">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Carregando arquivos...</p>
  </div>

  <!-- File Grid -->
  <div class="file-grid" *ngIf="!loading">
    <!-- Directories First -->
    <mat-card 
      *ngFor="let directory of directories" 
      class="file-card directory-card"
      (click)="onFileClick(directory)">
      <mat-card-content>
        <div class="file-icon-container">
          <mat-icon class="file-icon folder-icon">{{ directory.icon }}</mat-icon>
        </div>
        <h3>{{ directory.name }}</h3>
        <p class="file-details">Pasta</p>
        <p class="file-modified">{{ directory.modified | date:'short' }}</p>
      </mat-card-content>
    </mat-card>

    <!-- Files -->
    <mat-card 
      *ngFor="let file of files" 
      class="file-card"
      (click)="onFileClick(file)">
      <mat-card-content>
        <div class="file-icon-container">
          <mat-icon class="file-icon">{{ file.icon }}</mat-icon>
        </div>
        <h3>{{ file.name }}</h3>
        <p class="file-details">{{ file.sizeFormatted }}</p>
        <p class="file-modified">{{ file.modified | date:'short' }}</p>
        
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="!loading && directories.length === 0 && files.length === 0">
    <mat-icon>folder_open</mat-icon>
    <h3>Pasta vazia</h3>
    <p>Esta pasta não contém arquivos ou subpastas.</p>
  </div>

  <!-- File Preview -->
  <app-file-preview 
    *ngIf="selectedFile && showPreview"
    [file]="selectedFile"
    [showPreview]="showPreview"
    (showPreviewChange)="onPreviewChange($event)">
  </app-file-preview>
</div>